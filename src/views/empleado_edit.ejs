<%- include('partials/_header') %>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<div class="container mb-5">
    <div class="row mt-5">
        <div class="col-md-12">
            <div class="col-md-12">
                <div class="card ">
                    
                    <div class="card-body col-md-12">
                      
                        <div id="form_empleado" class="col-md-12" style="margin:0 auto">
                            <form class="row g-3"  action="/empleado/update/<%= empleado.id_empleado %>/0" enctype="multipart/form-data" method="post">
                              <div class="card-header bg-dark text-white d-flex">
                                <div class="col-9"><h5>Información - Básica - Empleado</h5></div>
                                
                                <label for="inputAddress2" class="form-label text-white">Fecha:</label>
                                    <input type="text" class="form-control bg-dark text-white" name="fecha" id="fecha" required readonly>
                                  
                            </div>
                            <div class="col-md-4">
                              <div class="d-flex justify-content-center">
                                <div class="image-container">
                                  <label for="file-input">
                                    <img id="preview-img" src="/../<%= empleado.path_foto %>" class="img-fluid"  width="300" height="400">
                                  </label>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-8 row">
                                <div class="col-md-6 pt-2">
                                    <label for="inputAddress2" class="form-label text-black">Nombres<strong style="color: red;">*</strong></label>
                                    <input type="hidden" class="form-control" name="id_emp" id="id_emp" placeholder="Mel Patsy" value="<%= empleado.id_empleado %>" required>
                                    <input type="text" class="form-control" name="nombres" id="nombres" placeholder="Mel Patsy" value="<%= empleado.nombres %>" maxlength ="45" required>
                                  </div>
                                  <div class="col-md-6 pt-2">
                                    <label for="inputAddress2" class="form-label text-black">Apellidos<strong style="color: red;">*</strong></label>
                                    <input type="text" class="form-control" name="apellidos" id="apellidos" placeholder="Martínez Darcy" maxlength="45" value="<%= empleado.apellidos %>" required>
                                  </div>
                                  <div class="col-md-6 pt-2">
                                    <label for="inputAddress2" class="form-label text-black">Cédula<strong style="color: red;">*</strong></label>
                                    <input type="text" class="form-control" name="cedula" id="cedula" onkeypress="handleMask(event, '999-9999999-9')" size=13 maxlength="45" value="<%= empleado.cedula %>" required>
                                  </div>
                               
                               <div class="col-md-3 pt-2">
                                <label for="inputEmail4" class="form-label text-black">Sexo<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="sexo" id="sexo" required>
                                   <option value="0">Seleccione el Sexo</option>
                                   <% if (empleado.sexo == "M"){%>
                                   <option value="M" selected >Masculino</option>
                                   <option value="F">Femenino</option>
                                   <% }else{%>
                                    <option value="M" >Masculino</option>
                                   <option value="F" selected>Femenino</option>
                                    <%}%>
                                 </select>
                              </div>

                              <div class="col-md-3 pt-2">
                                <label for="inputAddress2" class="form-label text-black">Fecha de Nacimiento<strong style="color: red;">*</strong></label>
                                <input type="date" class="form-control" name="fecha_nacimiento" id="fecha_nacimiento" min="1950" placeholder="000-0000000-0" value="<%= empleado.fecha_nacimiento %>" required>
                              </div>

                              <div class="col-md-6 pt-2">
                                <label for="inputEmail4" class="form-label text-black">Nacionalidad<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="nacionalidad" id="nacionalidad" required>
                                  <option value="0">Seleccione la Nacionalidad</option>
                                 
                                  <% if(nac) {%>
                                    <% for(var i =0;i < nac.length;i++){ 
                                      if(nac[i].id_nacionalidad == empleado.id_nacionalidad){%>
                                      <option selected value="<%= nac[i].id_nacionalidad %>"><%= nac[i].gentilicio %></option>
                                      <% }else { %>
                                        <option value="<%= nac[i].id_nacionalidad %>"><%= nac[i].gentilicio %></option>
                                       
                                     <% }
                                    } %>
                                    <% } %>
                                   
                                 </select>
                              </div>

                              <div class="col-md-3 pt-2">
                                <label for="inputEmail4" class="form-label text-black">Estado Civil<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="estado_civil" id="estado_civil" required>
                                   <option value="0">Seleccione el Estado Civil</option>
                                   <% if (empleado.estado_civil == "soltero"){%>
                                    <option selected value="soltero">Soltero</option>
                                    <option value="casado">Casado</option>
                                    <option value="union libre">Unión Libre</option>
                                    <option value="separado">Separado</option>
                                    <option value="divorciado">Divorciado</option>
                                    <option value="viudo">Viudo</option>
                                    <% }else if (empleado.estado_civil == "casado"){%>
                                      <option value="soltero">Soltero</option>
                                      <option selected value="casado">Casado</option>
                                      <option value="union libre">Unión Libre</option>
                                      <option value="separado">Separado</option>
                                      <option value="divorciado">Divorciado</option>
                                      <option value="viudo">Viudo</option>
                                     
                                     <% }else if (empleado.estado_civil == "union libre"){%>
                                      <option value="soltero">Soltero</option>
                                      <option value="casado">Casado</option>
                                      <option selected value="union libre">Unión Libre</option>
                                      <option value="separado">Separado</option>
                                      <option value="divorciado">Divorciado</option>
                                      <option value="viudo">Viudo</option>
                              
                                     <% }else if (empleado.estado_civil == "separado"){%>
                                      <option value="soltero">Soltero</option>
                                      <option value="casado">Casado</option>
                                      <option value="union libre">Unión Libre</option>
                                      <option selected value="separado">Separado</option>
                                      <option value="divorciado">Divorciado</option>
                                      <option value="viudo">Viudo</option>
                                    
                                     <% }else if (empleado.estado_civil == "divorciado"){%>
                                      <option value="soltero">Soltero</option>
                                      <option value="casado">Casado</option>
                                      <option value="union libre">Unión Libre</option>
                                      <option value="separado">Separado</option>
                                      <option selected value="divorciado">Divorciado</option>
                                      <option value="viudo">Viudo</option>
                                    
                                     <% }else if (empleado.estado_civil == "viudo"){%>
                                      <option value="soltero">Soltero</option>
                                      <option value="casado">Casado</option>
                                      <option value="union libre">Unión Libre</option>
                                      <option value="separado">Separado</option>
                                      <option value="divorciado">Divorciado</option>
                                      <option selected value="viudo">Viudo</option>

                                      <% }else if (empleado.estado_civil == ""){%>
                                        <option value="soltero">Soltero</option>
                                        <option value="casado">Casado</option>
                                        <option value="union libre">Unión Libre</option>
                                        <option value="separado">Separado</option>
                                        <option value="divorciado">Divorciado</option>
                                        <option value="viudo">Viudo</option>
                                       <%}%>
                                     
                                   
                                 </select>
                              </div>

                               <div class="col-md-3 pt-2">
                                 <label for="inputPassword4" class="form-label text-black">Dependientes<strong style="color: red;">*</strong></label>
                                 <input type="number" class="form-control" name="nhijos" id="nhijos" placeholder="00" min="0" maxlength="50" value="<%= empleado.nhijos %>" required>
                               </div>     
                               
                               <div class="col-md-6 pt-2">
                                <label for="inputEmail4" class="form-label text-black">Provincia<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="provincia" id="provincia" required>
                                   <option value="0">Seleccione la Provincia</option>
                                  <% if(prov) {%>
                                    <% for(var i =0;i < prov.length;i++){
                                      
                                      if(prov[i].id_provincia == empleado.id_provincia){%>
                                        <option selected value="<%= prov[i].id_provincia %>"><%= prov[i].provincia %></option>
                                        <% }else { %>
                                          <option value="<%= prov[i].id_provincia %>"><%= prov[i].provincia %></option>
                                         
                                       <% }
                                       
                                     } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-6 pt-2">
                                <label for="inputEmail4" class="form-label text-black">Municipio<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="municipio" id="municipio" required>
                                  <option value="0">Seleccione el Municipio</option>
                                  <% if(mun) {%>
                                    <% for(var i =0;i < mun.length;i++){
                                      
                                      if(mun[i].id_municipio == empleado.id_municipio){%>
                                        <option selected value="<%= mun[i].id_municipio %>"><%= mun[i].municipio %></option>
                                        <% }else { %>
                                          <option value="<%= mun[i].id_municipio %>"><%= mun[i].municipio %></option>
                                         
                                       <% }
                                       
                                     } %>
                                    <% } %>                                   
                                 </select>
                              </div>

                              <div class="col-md-6 pt-2">
                                <label for="inputEmail4" class="form-label text-black">Sector<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="sector" id="sector" required>
                                  <option value="0">Seleccione el Sector</option>
                                  <% if(sec) {%>
                                    <% for(var i =0;i < sec.length;i++){ 
                                      if(sec[i].id_sector == empleado.id_sector){%>
                                      <option selected value="<%= sec[i].id_sector %>"><%= sec[i].sector %></option>
                                      <% }else{ %>
                                        <option value="<%= sec[i].id_sector %>"><%= sec[i].sector %></option>
                                        <% } %>
                                     <% } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-6 pt-2">
                                <label for="inputPassword4" class="form-label text-black">Dirección<strong style="color: red;">*</strong></label>
                                <input type="text" class="form-control" name="direccion" id="direccion" placeholder="Ejemplo: C/principal #22" maxlength="100" value="<%= empleado.direccion %>" required>
                              </div>  
                              </div>

                              <div class="card-header mt-5 bg-dark text-white">
                                <h5>Información - Académica</h5>
                            </div>
                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Grado Académico<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="grado_ac" id="grado_ac" required>
                                   <option value="">Seleccione el grado académico</option>
                                   
                                  <% if(graac) {%>
                                    <% for(var i =0;i < graac.length;i++){ 
                                      if(graac[i].id_grado_ac == empleado.id_grado_ac){%>
                                      <option selected value="<%= graac[i].id_grado_ac %>"><%= graac[i].descripcion %></option>
                                      <% }else { %>
                                        <option value="<%= graac[i].id_grado_ac %>"><%= graac[i].descripcion %></option>
                                       
                                     <% }
                                    } %>
                                    <% } %>

                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Nivel<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="nivel" id="nivel" required>
                                   <option value="">Seleccione el nivel</option>

                                   <% if(niv) {%>
                                    <% for(var i =0;i < niv.length;i++){ 
                                      if(niv[i].id_nivel == empleado.id_nivel){%>
                                      <option selected value="<%= niv[i].id_nivel %>"><%= niv[i].descripcion %></option>
                                      <% }else { %>
                                        <option value="<%= niv[i].id_nivel %>"><%= niv[i].descripcion %></option>
                                       
                                     <% }
                                    } %>
                                    <% } %>

                                 </select>
                              </div>


                              
                              <div class="card-header mt-5 bg-dark text-white">
                                <h5>Información - Contacto</h5>
                            </div>

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Teléfono</label>
                                <input type="text" class="form-control" name="telefono" id="telefono" onkeypress="handleMask(event, '999-999-9999')" size=13 value="<%= empleado.tel %>" placeholder="000-000-0000">
                              </div>  
                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Celular<strong style="color: red;">*</strong></label>
                                <input type="text" class="form-control" name="celular" id="celular" onkeypress="handleMask(event, '999-999-9999')" size=13 placeholder="000-000-0000" value="<%= empleado.cel %>" required>
                              </div>  
                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Correo Electrónico<strong style="color: red;">*</strong></label>
                                <input type="email" class="form-control" name="email_personal" id="email_personal" placeholder="Ejemplo: example@gmail.com" maxlength="100" value="<%= empleado.email_personal %>" required>
                              </div>  
                                                            
                              <div class="card-header mt-5 bg-dark text-white">
                                <h5><strong>Información - Emergencia</strong></h5>
                            </div>

                            <div class="col-md-12">
                              <label for="inputPassword4" class="form-label text-black">Contacto<strong style="color: red;">*</strong></label>
                              <input type="text" class="form-control" name="contacto" id="contacto" value="<%= empleado.contacto_emergencia %>" maxlength="50" placeholder="Nombre y apellido" required>
                            </div>  

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Relación<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="relacion" id="relacion">
                                   <option value="">Seleccione</option>
                                   <% if(rel) {%>
                                    <% for(var i =0;i < rel.length;i++){ 
                                      if(rel[i].id_relacion == empleado.id_relacion){%>
                                      <option selected value="<%= rel[i].id_relacion %>"><%= rel[i].relacion %></option>
                                      <% }else { %>
                                        <option value="<%= rel[i].id_relacion %>"><%= rel[i].relacion %></option>
                                     <% }
                                    } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Tel</label>
                                <input type="text" class="form-control" name="tel" id="tel" onkeypress="handleMask(event, '999-999-9999')" size=13 value="<%= empleado.tel_emergencia %>" placeholder="000-000-0000">
                              </div>  

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Cel<strong style="color: red;">*</strong></label>
                                <input type="text" class="form-control" name="cel" id="cel" onkeypress="handleMask(event, '999-999-9999')" size=13 value="<%= empleado.cel_emergencia %>" placeholder="000-000-0000" required>
                              </div> 


                              
                              <div class="card-header mt-5 bg-dark text-white">
                                <h5><strong>Información - Salud</strong></h5>
                            </div>

                            <div class="col-md-12">
                              <div class="col-md-8">
                                <label for="inputPassword4" class="form-label text-black">Padece alguna Enfermedad<strong style="color: red;">*</strong></label>
                              </div>  
  
                                <div class="col-md-12 d-flex">
                                  <div class="col-md-3">
                                    <select class="form-control" name="enfermedad" id="enfermedad" required>
                                      <option value="">Seleccione</option>
                                        <% if (empleado.enfermedad == "si"){%>
                                        <option value="si" selected >Si</option>
                                        <option value="no">No</option>
                                        <% }else{%>
                                        <option value="si" >Si</option>
                                        <option value="no" selected>No</option>
                                        <%}%>
                                     </select>
                                     
                                  </div>
    
                                  <div class="col-9 mx-3">
                                    <input type="text" class="form-control" name="tipo_enfermedad" id="tipo_enfermedad" value="<%= empleado.tipo_enfermedad %>" maxlength="200" placeholder="Ejemplo: Mal de Parquinson">
                                  </div>  
                                </div>
                            </div>  

                            <div class="col-md-12">
                              <div class="col-8">
                                <label for="inputPassword4" class="form-label text-black">Alergias<strong style="color: red;">*</strong></label>
                              </div>  
  
                                <div class="col-md-12 d-flex">
                                  <div class="col-md-3">
                                    <select class="form-control" name="alergia" id="alergia" required>
                                      <option value="">Seleccione</option>
                                      <% if (empleado.alergia == "si"){%>
                                        <option value="si" selected >Si</option>
                                        <option value="no">No</option>
                                        <% }else{%>
                                        <option value="si" >Si</option>
                                        <option value="no" selected>No</option>
                                        <%}%>
                                     </select>
                                     
                                  </div>
    
                                  <div class="col-9 mx-3">
                                    <input type="text" class="form-control" name="tipo_alergia" id="tipo_alergia" value="<%= empleado.tipo_alergia %>" maxlength="200" placeholder="Ejemplo: A la penicilina">
                                  </div>  
                                </div>
                            </div>  

                            <div class="col-md-12">
                              <div class="col-md-9">
                                <label for="inputPassword4" class="form-label text-black">Utiliza algún medicamento<strong style="color: red;">*</strong></label>
                              </div>  
  
                                <div class="col-md-12 d-flex">
                                  <div class="col-md-3">
                                    <select class="form-control" name="medicacion" id="medicacion" required>
                                      <option value="">Seleccione</option>
                                      <% if (empleado.medicacion == "si"){%>
                                        <option value="si" selected >Si</option>
                                        <option value="no">No</option>
                                        <% }else{%>
                                        <option value="si" >Si</option>
                                        <option value="no" selected>No</option>
                                        <%}%>
                                     </select>
                                     
                                  </div>
    
                                  <div class="col-9 mx-3">
                                    <input type="text" class="form-control" name="tipo_medicamento" id="tipo_medicamento" value="<%= empleado.tipo_medicamento %>" maxlength="200" placeholder="Aspirina 500">
                                  </div>  
                                </div>
                            </div>  

                              
                          <div class="card-header mt-5 bg-dark text-white">
                            <h5><strong>Documentos</strong></h5>
                        </div>
                            <div class="col-md-12">
                              <% if(docs) {%>
                                <% for(var i =0;i < docs.length;i++){ %>
                                    <a class="btn btn-outline-primary" href="/../<%= docs[i].path %>" target="_blank" style='font-size:16px;'><%= docs[i].descripcion %></a>
                                  
                                  <% 
                                } %>
                                <% } %>
                            </div> 
                            
                            <div class="col-8">
                              <input type="hidden" class="form-control" name="files_cita" id="files_cita" value="empleado" required>
                              <label for="inputAddress2" class="form-label text-black">Descripción del documento</label>
                              <input type="text" class="form-control" name="descripcion" id="descripcion">
                            </div>
                            <div class="col-md-4">
                              <label for="inputPassword4" class="form-label text-black">Subir documento</label>
                              <input type="file" class="form-control" name="file" id="file" >
                            </div> 

                              <div class="card-header mt-5 bg-dark text-white">
                                <h5>Información - Empresa</h5>
                            </div>
                            <% if(accesos.master) {%>
                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Empresa<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="empresa" id="empresa" required>
                                   <option value="">Seleccione la empresa</option>
                                   <% if(emp) {%>
                                    <% for(var i =0;i < emp.length;i++){ 
                                      if(emp[i].id_negocio == empleado.id_negocio){%>
                                      <option selected value="<%= emp[i].id_negocio %>"><%= emp[i].razon_social %></option>
                                      <% }else{ %>
                                        <option value="<%= emp[i].id_negocio %>"><%= emp[i].razon_social%></option>
                                        <% } %>
                                     <% } %>
                                    <% } %>
                                 </select>
                              </div>
                              <% } else{ %>
                                <div class="col-md-4">
                                  <label for="inputPassword4" class="form-label text-black">Empresa<strong style="color: red;">*</strong></label>
                                  <input type="hidden" class="form-control" name="empresa" id="empresa" value="<%= empleado.id_negocio %>">
                                  <% if(emp) {%>
                                    <% for(var i =0;i < emp.length;i++){ 
                                      if(emp[i].id_negocio == empleado.id_negocio){%>
                                        <input type="text" class="form-control" name="empresa" id="empresa" value="<%= emp[i].razon_social %>" disabled>
                                      <% }else{ %>
                                        
                                        <% } %>
                                     <% } %>
                                    <% } %>
                                </div> 
                                <% } %>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Sucursal<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="sucursal" id="sucursal" required>
                                   <option value="">Seleccione la sucursal</option>
                                   <% if(suc) {%>
                                    <% for(var i =0;i < suc.length;i++){ 
                                      if(suc[i].id_sucursal == empleado.id_sucursal){%>
                                      <option selected value="<%= suc[i].id_sucursal %>"><%= suc[i].nombre_sucursal %></option>
                                      <% }else{ %>
                                        <option value="<%= suc[i].id_sucursal %>"><%= suc[i].nombre_sucursal%></option>
                                        <% } %>
                                     <% } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Departamento<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="departamento" id="departamento" required>
                                   <option value="">Seleccione el departamento</option>
                                   <% if(dep) {%>
                                    <% for(var i =0;i < dep.length;i++){ 
                                      if(dep[i].id_departamento == empleado.id_departamento){%>
                                      <option selected value="<%= dep[i].id_departamento %>"><%= dep[i].descripcion %></option>
                                       <% }else {%>
                                        <option value="<%= dep[i].id_departamento %>"><%= dep[i].descripcion %></option>
                                     <% }
                                    } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Puesto<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="puesto" id="puesto" required>
                                   <option value="">Seleccione el puesto</option>
                                   <% if(pue) {%>
                                    <% for(var i =0;i < pue.length;i++){
                                      if(pue[i].id_puesto == empleado.id_puesto){ %>
                                      <option selected value="<%= pue[i].id_puesto %>"><%= pue[i].descripcion %></option>
                                      <% }else {%>
                                        <option value="<%= pue[i].id_puesto %>"><%= pue[i].descripcion %></option>
                                      <% }
                                    } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Encargado</label>
                                <select class="form-control" name="encargado" id="encargado" required>
                                   <option value="0">Seleccione el encargado</option>
                                   <% if(enc) {%>
                                    <% for(var i =0;i < enc.length;i++){ 
                                      if(enc[i].id_empleado == empleado.id_encargado){%>
                                      <option selected value="<%= enc[i].id_empleado %>"><%= enc[i].nombres+" "+enc[i].apellidos %></option>
                                      <% }else { %>
                                        <option value="<%= enc[i].id_empleado %>"><%= enc[i].nombres+" "+enc[i].apellidos %></option>
                                       
                                     <% }
                                    } %>
                                    <% } %>

                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Grado<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="grado" id="grado" required>
                                   <option value="">Seleccione el grado</option>
                                   <% if(gra) {%>
                                    <% for(var i =0;i < gra.length;i++){ 
                                      if(gra[i].id_grado == empleado.id_grado){%>
                                      <option selected value="<%= gra[i].id_grado %>"><%= gra[i].grado %></option>
                                      <% }else { %>
                                        <option value="<%= gra[i].id_grado %>"><%= gra[i].grado %></option>
                                     <% }
                                    } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Modalidad<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="tipo_empleado" id="tipo_empleado" required>
                                   <option value="">Seleccione la Modalidad</option>
                                   <% if(mod) {%>
                                    <% for(var i =0;i < mod.length;i++){ 
                                      if(mod[i].id_tipo_empleado == empleado.id_tipo_empleado){%>
                                      <option selected value="<%= mod[i].id_tipo_empleado %>"><%= mod[i].tipo_empleado %></option>
                                      <% }else { %>
                                        <option value="<%= mod[i].id_tipo_empleado %>"><%= mod[i].tipo_empleado %></option>
                                     <% }
                                    } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Sueldo</label>
                                <select class="form-control" name="sueldo" id="sueldo" required>
                                   <option value="0">Seleccione el Sueldo</option>
                                   <% if(suel) {%>
                                    <% for(var i =0;i < suel.length;i++){ 
                                      if(suel[i].id_sueldo == empleado.id_sueldo){%>
                                      <option selected value="<%= suel[i].id_sueldo %>"><%= suel[i].sueldo %></option>
                                      <% }else { %>
                                        <option value="<%= suel[i].id_sueldo %>"><%= suel[i].sueldo %></option>
                                     <% }
                                    } %>
                                    <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputAddress2" class="form-label text-black">Fecha de entrada<strong style="color: red;">*</strong></label>
                                <input type="date" class="form-control" name="fecha_entrada" id="fecha_entrada" value="<%= empleado.fecha_entrada %>" placeholder="000-0000000-0" required>
                              </div>

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Tarjeta de Puntos</label>
                                <input type="text" class="form-control" name="tarjeta_punto" id="tarjeta_punto" value="<%= empleado.tarjeta_punto %>" maxlength="11" placeholder="00">
                              </div>  

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Tarjeta de combustible</label>
                                <input type="text" class="form-control" name="tarjeta_combustible" id="tarjeta_combustible" value="<%= empleado.tarjeta_combustible %>" maxlength="25" placeholder="0">
                              </div>
                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Monto combustible</label>
                                <input type="number" min="0" max="25000" class="form-control" name="monto_combustible" id="monto_combustible" value="<%= empleado.monto_combustible %>" maxlength="11" placeholder="0">
                              </div>  
                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Monto por vehiculo</label>
                                <input type="text" class="form-control" name="monto_vehiculo" id="monto_vehiculo" value="<%= empleado.monto_vehiculo %>" maxlength="11" placeholder="0">
                              </div>

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Código</label>
                                <input type="text" class="form-control" name="codigo" id="codigo" value="<%= empleado.codigo %>" maxlength="15" placeholder="ingrese el código de empleado">
                              </div>  

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Correo de la Empresa</label>
                                <input type="text" class="form-control" name="email_institucional" id="email_institucional"  value="<%= empleado.email_institucional %>" maxlength="45" placeholder="ingrese el correo de la empresa">
                              </div>  

                              
                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Flota</label>
                                <input type="text" class="form-control" name="flota" id="flota" onkeypress="handleMask(event, '999-999-9999')" value="<%= empleado.flota %>" size=13 placeholder="000-000-0000">
                              </div> 

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Seguro médico</label>
                                <select class="form-control" name="seguro_medico" id="seguro_medico" required>
                                   <option value="0">Seleccione</option>
                                    <% if(sm) {%>
                                      <% for(var i =0;i < sm.length;i++){ 
                                        if(sm[i].id_seguro_medico== empleado.id_seguro_medico){%>
                                        <option selected value="<%= sm[i].id_seguro_medico %>"><%= sm[i].seguro %></option>
                                        <% }else { %>
                                          <option value="<%= sm[i].id_seguro_medico %>"><%= sm[i].seguro %></option>
                                       <% }
                                      } %>
                                      <% } %>
                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputPassword4" class="form-label text-black">Número de cuenta</label>
                                <input type="text" class="form-control" name="numero_cuenta" id="numero_cuenta" value="<%= empleado.numero_cuenta %>" size=25>
                              </div> 

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Banco</label>
                                <select class="form-control" name="banco" id="banco">
                                   <option value="0">Seleccione</option>
                                   <% if(banco) {%>
                                    <% for(var i =0;i < banco.length;i++){ 
                                      if(banco[i].id_banco == empleado.id_banco){%>
                                      <option selected value="<%= banco[i].id_banco %>"><%= banco[i].nombre %></option>
                                      <% }else { %>
                                        <option value="<%= banco[i].id_banco %>"><%= banco[i].nombre %></option>
                                     <% }
                                    } %>
                                    <% } %>

                                 </select>
                              </div>

                              <div class="col-md-4">
                                <label for="inputEmail4" class="form-label text-black">Estado<strong style="color: red;">*</strong></label>
                                <select class="form-control" name="estado" id="estado" required>
                                   <option value="">Seleccione el Estado</option>
                                   <% if(est) {%>
                                    <% for(var i =0;i < est.length;i++){ 
                                      if(est[i].id_estado == empleado.id_estado){%>
                                      <option selected value="<%= est[i].id_estado %>"><%= est[i].descripcion %></option>
                                      <% }else { %>
                                        <option value="<%= est[i].id_estado %>"><%= est[i].descripcion %></option>
                                     <% }
                                    } %>
                                    <% } %>

                                 </select>
                              </div>

                               <div id="guardar_empleado" class="col-12 mt-5 text-center">
                                 <button type="submit" class="btn btn-primary col-4">GUARDAR</button>
                               </div>

                             </form>
                             <div id="salida_empleado">
                              <form class="row g-3"  action="/empleado/out/<%= empleado.id_empleado %>" method="post">
                              <div class="card-header mt-5 bg-dark text-white">
                                <h5><strong>Información de salida de la Empresa</strong></h5>
                              </div>
                              <div class="col-md-12 mt-3">
                                <div class="col-md-12 d-flex">
                                  <div class="col-md-3">
                                    <label for="inputPassword4" class="form-label text-black">Tipo de Salida</label>
                                    <select class="form-control" name="salida" id="salida" required>
                                     <option value="">Seleccione</option>
                                      <% if(sal) {%>
                                       <% for(var i =0;i < sal.length;i++){ %>
                                         <option value="<%= sal[i].id_salida %>"><%= sal[i].salida %></option>
                                          
                                        <% } %>
                                       <% } %>
                                     </select>
                                     
                                  </div> 
                                  <div class="col-md-2.2 mx-3">
                                    <label for="inputPassword4" class="form-label text-black">Fecha de Salida</label>
                                    <input type="date" class="form-control" name="fecha_salida" id="fecha_salida" >
                                  </div>
                                  
                                </div>
                                
                                <div class="col-md-4 mt-3">
                                  <label for="inputPassword4" class="form-label text-black">Motivo</label>
                                </div> 
                                <div class="col-md-12">
                                  <textarea class="col-md-12" name="motivo" id="motivo" cols="auto" rows="3" maxlength="255"></textarea>                                
                                </div>  
                                 
                            </div>  
                            <% if(accesos.editar_empleado) {%>
                            <div class="col-12">
                              <button type="submit" id="btnSalida" class="btn btn-primary">GUARDAR</button>
                            </div>
                            <% } %>
                             </form>
                             <% if(accesos.activar_empleado) {%>
                             
                              <form class="row"  action="/empleado/activar/<%= empleado.id_empleado %>" method="post">
                                <div class="col-md-12 mt-4">
                                  <button type="submit" id="btnActivar" class="btn btn-success">ACTIVAR</button>
                                </div>
                                 
                             </form>
                             <% } %>
                            </div>
                          
                           </div>
                           
                           
                    </div>
                </div>
            </div>

        </div>
        
    </div>
</div>




<!-- Modal para cambiar la imagen del cliente-->
<div class="modal" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">
      
      <!-- Modal body -->
      <div class="modal-body">
        <img id="modal-img" class="img-fluid">
        <form id="modal-form" action="/empleado/foto/<%= empleado.id_empleado %>/0" enctype="multipart/form-data" method="post" >
          <input type="hidden" class="form-control" name="files_cita" id="files_cita" value="empleado_foto" required>
          <input id="modal-file-input" name="file" id="file" type="file" style="display: none;">
          
          <button class="btn btn-outline-primary col-12" id="select-button" type="button">Seleccionar imagen</button>
          <div class="text-center pt-2">
            <button class="btn btn-primary col-4" id="submit-button" type="submit">Cambiar</button>
          </div>
        </form>
      </div>
      
    </div>
  </div>
</div>

<script >
var previewImg = document.getElementById('preview-img');
  var modal = document.getElementById('myModal');
  var modalImg = document.getElementById('modal-img');
  var modalForm = document.getElementById('modal-form');
  var modalFileInput = document.getElementById('modal-file-input');
  var selectButton = document.getElementById('select-button');

  // Agregar evento 'click' al elemento previewImg
  previewImg.addEventListener('click', function() {
    modal.style.display = "block";
    modalImg.src = previewImg.src;
  });

  // Agregar evento 'change' al elemento modalFileInput
  modalFileInput.addEventListener('change', function() {
    const file = this.files[0];
    const reader = new FileReader();

    reader.addEventListener('load', function() {
      modalImg.setAttribute('src', reader.result);
    });

    reader.readAsDataURL(file);
  });

  // Agregar evento 'submit' al formulario modalForm
  modalForm.addEventListener('submit', function(event) {
    event.preventDefault();
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/upload-image');
    xhr.send(new FormData(modalForm));
    modal.style.display = "none";
  });

  // Agregar evento 'click' al botón selectButton
  selectButton.addEventListener('click', function() {
    modalFileInput.click();
  });

  // Agregar evento 'click' al botón submit-button
  var submitButton = document.getElementById('submit-button');
  submitButton.addEventListener('click', function() {
    modalForm.submit();
  });

  // Agregar evento 'click' a cualquier parte fuera del modal para cerrarlo
  window.addEventListener('click', function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  });


//////////////////////////////////////////////////////////////////////

function handleNacionalidad() {
  console.log("ID: ");
  
  $.get("/empleado", function (data) {
      var municipios = data.municipios;

  });

}

function handleProvincia(e) {
  console.log("ID: ", e.target.value);

  $.get("/form-data/municipios?provincia=" + e.target.value, function (data) {
      var municipios = data.municipios;

     console.log(municipios)
  });
}

function handleMunicipio(e) {
  console.log("ID: ", e.target.value);

  $.get("/form_data/municipio/" + e.target.value, function (data) {
      console.log(data)
      var municipio = data;  // FALTA RENDERIZAR LOS DATOS EN EL SELECT
      var html = "";
      html +="<option value=0>Seleccione el municipio</option>";
      for(var i =0;i < data.length;i++){ 
              html +="<option value="+data[i].id_municipio+">"+data[i].municipio+"</option>";
              console.log(data[i]);                    
        }

      var elementMunicipio = document.getElementById("municipio");
      elementMunicipio.innerHTML = html;


      
  });
}

function handleSector(e) {
  //console.log("ID: ", e.target.value);

  $.get("/form_data/sector/" + e.target.value, function (data) {
      //console.log(data)
      var sector = data;  // FALTA RENDERIZAR LOS DATOS EN EL SELECT
      var html = "";
      html +="<option value=0>Seleccione el sector</option>";
      for(var i =0;i < data.length;i++){ 
              html +="<option value="+data[i].id_sector+">"+data[i].sector+"</option>";
              //console.log(data[i]);                    
        }

      var elementSector = document.getElementById("sector");
      elementSector.innerHTML = html;


      
  });
}

function handleEncargado(e) { // el id que llega es el id del departamento
  console.log("ID: ", e.target.value);

  $.get("/form_data/encargado/" + e.target.value, function (data) {
      //console.log(data)
      var sector = data;  // FALTA RENDERIZAR LOS DATOS EN EL SELECT
      var html = "";
      html +="<option value=0>Seleccione el encargado</option>";
      for(var i =0;i < data.length;i++){ 
              html +="<option value="+data[i].id_empleado+">"+data[i].nombres+" "+data[i].apellidos+"</option>";
              //console.log(data[i]);                    
        }

      var elementEncargado = document.getElementById("encargado");
      elementEncargado.innerHTML = html;
      
  });
}

function handleSalida() { // el id que llega es el id del departamento
  let id_empleado = document.getElementById('id_emp').value;

  $.get("/form_data/salida/" + id_empleado, function (data) {
    let fecha = formatFecha(data[0].fecha);
      document.getElementById('salida').selectedIndex = data[0].id_salida;
      document.getElementById('motivo').value = data[0].motivo;
      document.getElementById('fecha_salida').value = fecha;
      
     
      
  });
}

function fechaActual(){
  date = new Date();
  year = date.getFullYear();
  month = date.getMonth() + 1;
  day = date.getDate();
  return  day + "/" + month + "/" + year;
  
}
function formatFecha(fecha){
    let fechavieja = new Date(fecha).toLocaleDateString();                                                                   
    let nueva =fechavieja.split("/");
    if(nueva[1].length ==1){
        nueva[1]="0"+nueva[1];
        }
    if(nueva[0].length ==1){
        nueva[0]="0"+nueva[0];
        }
    fecha = nueva[2]+'-'+nueva[1] +'-'+nueva[0];
    return fecha;
}

function handleMask(event, mask) {
    with (event) {
        stopPropagation()
        preventDefault()
        if (!charCode) return
        var c = String.fromCharCode(charCode)
        if (c.match(/\D/)) return
        with (target) {
            var val = value.substring(0, selectionStart) + c + value.substr(selectionEnd)
            var pos = selectionStart + 1
        }
    }
    var nan = count(val, /\D/, pos) // nan va calcolato prima di eliminare i separatori
    val = val.replace(/\D/g,'')

    var mask = mask.match(/^(\D*)(.+9)(\D*)$/)
    if (!mask) return // meglio exception?
    if (val.length > count(mask[2], /9/)) return

    for (var txt='', im=0, iv=0; im<mask[2].length && iv<val.length; im+=1) {
        var c = mask[2].charAt(im)
        txt += c.match(/\D/) ? c : val.charAt(iv++)
    }

    with (event.target) {
        value = mask[1] + txt + mask[3]
        selectionStart = selectionEnd = pos + (pos==1 ? mask[1].length : count(value, /\D/, pos) - nan)
    }

    function count(str, c, e) {
        e = e || str.length
        for (var n=0, i=0; i<e; i+=1) if (str.charAt(i).match(c)) n+=1
        return n
    }
}

function puestoList(empresa) { // el id que llega es el id del departamento
    //console.log("ID: ", e.target.value);

    const jsonAccesos = '<%- JSON.stringify(accesos) %>';
    var accesos = JSON.parse(jsonAccesos);

   
    $.get("/form_data/puesto/" + empresa, function (data) {
        // console.log(data)
        
      html = "";
      html +="<option value=0>Seleccione</option>";
      for(var j =0;j < data[0].length;j++){ 
              html +="<option value="+data[0][j].id_puesto+">"+data[0][j].descripcion+"</option>";
              // console.log(data[i]);                    
        }

      var elementPuesto = document.getElementById("puesto");
      elementPuesto.innerHTML = html;
        
    });
 
  }

  function departamentoList(empresa) { // el id que llega es el id del departamento
    //console.log("ID: ", e.target.value);

    const jsonAccesos = '<%- JSON.stringify(accesos) %>';
    var accesos = JSON.parse(jsonAccesos);

   
    $.get("/form_data/departamento/" + empresa, function (data) {
        console.log(data)
        
        html = "";
      html +="<option value=0>Seleccione</option>";
      for(var j =0;j < data[0].length;j++){ 
              html +="<option value="+data[0][j].id_departamento+">"+data[0][j].descripcion+"</option>";
              // console.log(data[i]);                    
        }

      var elementPuesto = document.getElementById("departamento");
      elementPuesto.innerHTML = html;
    });
 
  }

window.addEventListener('load', function() {
  //const nacionalidad = document.getElementById("nacionalidad");
 
  //$("#fecha").val(fechaActual());
  // console.log('no se desplieaga')
  var salida_empleado = document.getElementById("salida_empleado");
  salida_empleado.style.display = "none";//Oculto el div de salida del empleado
  /////////////determino si el empleado esta activo o//////////////////////
/* Para obtener el texto */
    var combo = document.getElementById("estado");
    var selectedes = combo.options[combo.selectedIndex].text;
    if(selectedes == "Inactivo"){
      handleSalida();
      

      $( "input" ).prop( "disabled", true ); //Disable
      combo.setAttribute('disabled', true);
      salida_empleado.style.display = "block";
      document.getElementById("guardar_empleado").style.display = "none";
      document.getElementById("btnSalida").style.display = "none";
      document.getElementById("salida").disabled = true;
      document.getElementById("motivo").disabled = true;


    }

    document.getElementById("empresa").onchange = function(e) {
      let valor = e.target.value;
      puestoList(valor);
      departamentoList(valor);
      // document.getElementById("empresa").value = this.value;
    };

    /////////////////////////////

  
  document.getElementById("fecha").value = new Date().toLocaleDateString();
 
  document.getElementById("provincia").onchange = function(e) {
    handleMunicipio(e);
  };

  document.getElementById("municipio").onchange = function(e) {
    handleSector(e);
  };

  document.getElementById("puesto").onchange = function(e) {
    handleEncargado(e);
    console.log('entro al puesto')
  };
  document.getElementById("estado").onchange = function(e) {
    
    //var cod = document.getElementById("estado").value;
/* Para obtener el texto */
    var combo = document.getElementById("estado");
    var selected = combo.options[combo.selectedIndex].text;
    if(selected == "Inactivo"){
      salida_empleado.style.display = "block";
      document.getElementById("guardar_empleado").style.display = "none";
      document.getElementById('form_empleado').setAttribute('disabled', true);
      document.getElementById("form_empleado").disabled = true;
      document.getElementById("btnActivar").style.display = "none";
      document.getElementById('salida').focus();
      //$("div *").disable();
    }else{
      salida_empleado.style.display = "none";
      document.getElementById("guardar_empleado").style.display = "block";
      //element.removeAttribute("disabled");
///or set that property directly:

//element.disabled = false;
    }
  };

});
</script>



<%- include('partials/_footer') %>